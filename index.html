<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IITM BS Data Science Grade Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .level-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .level-btn {
            padding: 15px 30px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #495057;
        }

        .level-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .level-btn.active {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-color: #4facfe;
        }

        .course-selector {
            margin-bottom: 30px;
        }

        .course-selector select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
        }

        .course-selector select:focus {
            outline: none;
            border-color: #4facfe;
        }

        .input-section {
            display: none;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .input-section.active {
            display: block;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
        }

        .input-group input {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
        }

        .input-group input:focus {
            outline: none;
            border-color: #4facfe;
        }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .result-section {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            display: none;
        }

        .result-section.active {
            display: block;
        }

        .result-value {
            font-size: 3rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .result-grade {
            font-size: 1.5rem;
            text-align: center;
            font-weight: 600;
            color: #34495e;
        }

        .formula-display {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #4facfe;
        }

        .formula-display h4 {
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .formula-display code {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            display: block;
            font-family: 'Courier New', monospace;
        }

        .info-box {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .info-box h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
        }

        .info-box li {
            margin-bottom: 5px;
            color: #424242;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .level-btn {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
        }

        .pill {
  display:inline-block;padding:4px 10px;border-radius:999px;
  background:#e9f5ff;border:1px solid #bee3f8;color:#1e3a8a;
  font-size:.85rem;margin-right:8px;margin-top:8px
}
.hint{font-size:.9rem;color:#6b7280;margin-top:6px}
.small-muted{font-size:.9rem;color:#555}


.warning-line{color:#b91c1c;font-weight:600;margin-top:6px}
.footer-note{
  margin:24px 0 0; background:#fff3cd; border:1px solid #ffeeba;
  color:#856404; padding:12px 16px; border-radius:10px; text-align:center
}


    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>IITM BS Data Science</h1>
            <p>Grade Calculator - May 2025 Term</p>
        </div>
        
        <div class="main-content">
            <div class="level-selector">
                <button class="level-btn active" data-level="foundation">Foundation</button>
                <button class="level-btn" data-level="diploma">Diploma</button>
                <button class="level-btn" data-level="degree">Degree</button>
            </div>
            
            <div class="course-selector">
                <select id="courseSelect">
                    <option value="">Select a course...</option>
                </select>
            </div>
            
            <div id="inputSection" class="input-section">
                <div id="inputGrid" class="input-grid">
                    <!-- Dynamic inputs will be inserted here -->
                </div>
                <button class="calculate-btn" onclick="calculateGrade()">Calculate Grade</button>
            </div>
            
            <div id="resultSection" class="result-section">
                <div class="result-value" id="resultValue">--</div>
                <div class="result-grade" id="resultGrade">Select course and enter values</div>
                <div class="formula-display">
                    <h4>Formula Used:</h4>
                    <code id="formulaDisplay">Select a course to see the formula</code>
                </div>
                <div class="info-box" id="infoBox">
                    <h4>Important Notes:</h4>
                    <ul id="infoList">
                        <li>Enter 0 for components you didn't attempt</li>
                        <li>All scores should be entered as percentages (0-100)</li>
                        <li>Result is capped at 100 unless specified otherwise</li>
                    </ul>
                </div>
            </div>
            <!-- <div class="footer-note" id="globalDisclaimer">
  ‚ö†Ô∏è This is a calculator, not your official score. Please check your dashboard
   for the final result. Until then, enjoy the term-break , best of luck for your next term! üôÇ
</div> -->


        </div>
    </div>

    <script>
  // --- grade mapping (kept same) ---
  function getGradeFromScore(score) {
    if (score >= 90) return 'S';
    if (score >= 80) return 'A';
    if (score >= 70) return 'B';
    if (score >= 60) return 'C';
    if (score >= 50) return 'D';
    if (score >= 40) return 'E';
    return 'U';
  }

  // --- Input helpers with hints ---
  function makeInputGroup({label, id, min=0, max=100, step=0.01, placeholder="Enter score (0-100)", hint=""}) {
    const wrap = document.createElement('div');
    wrap.className = 'input-group';
    const lab = document.createElement('label');
    lab.htmlFor = id; lab.textContent = label;
    const inp = document.createElement('input');
    inp.type = 'number'; inp.id = id; inp.min = String(min); inp.max = String(max);
    inp.step = String(step); inp.placeholder = placeholder; inp.title = hint || label;
    const hintEl = document.createElement('div');
    hintEl.className = 'hint'; hintEl.textContent = hint;
    wrap.appendChild(lab); wrap.appendChild(inp);
    if (hint) wrap.appendChild(hintEl);
    return wrap;
  }

  // --- Course catalog with two fixes (BA + Java) & concise hints ---
  const courses = {
    foundation: {
      "Mathematics for Data Science 1": {
        inputs: [
          {label:"GAA", hint:"Avg. of first 10 graded assignments"},
          {label:"Quiz 1"},
          {label:"Quiz 2"},
          {label:"Final Exam"}
        ],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2)",
        pills: ["Max-of-two-branches"],
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "English 1": {
        inputs: [
          {label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}
        ],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2)",
        pills: ["Max-of-two-branches"],
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "Computational Thinking": {
        inputs: [
          {label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}
        ],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2)",
        pills: ["Max-of-two-branches"],
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "Statistics for Data Science 1": {
        inputs: [
          {label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},
          {label:"Final Exam"},
          {label:"Extra Activity Bonus", hint:"0‚Äì5 allowed", min:0, max:5}
        ],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2) + Bonus",
        pills: ["Bonus up to +5","Cap 105"],
        calculate: ([gaa,q1,q2,f,bonus]) => Math.min(105, 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2) + (bonus||0)),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "Mathematics for Data Science 2": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2)",
        pills: ["Max-of-two-branches"],
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "English 2": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2)",
        pills: ["Max-of-two-branches"],
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "Intro to Python Programming": {
        inputs: [
          {label:"GAA1 (Objective)"}, {label:"GAA2 (Programming)"},
          {label:"Quiz 1"}, {label:"OPPE1"}, {label:"OPPE2"}, {label:"Final Exam"}
        ],
        formula: "T = 0.1¬∑GAA1 + 0.1¬∑GAA2 + 0.1¬∑Q1 + 0.4¬∑F + 0.25¬∑max(PE1,PE2) + 0.15¬∑min(PE1,PE2)",
        pills: ["Cap 100"],
        calculate: ([g1,g2,q1,pe1,pe2,f]) => Math.min(100, 0.1*g1 + 0.1*g2 + 0.1*q1 + 0.4*f + 0.25*Math.max(pe1,pe2) + 0.15*Math.min(pe1,pe2)),
        eligibility: "GrPA 1‚Äì4 & 5‚Äì8 ‚â• 40% (OPPE eligibility) + final eligibility; ‚â•40% in one OPPE"
      },
      "Statistics for Data Science 2": {
        inputs: [
          {label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},
          {label:"Final Exam"},{label:"Extra Activity Bonus", hint:"0‚Äì5 allowed", min:0, max:5}
        ],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2) + Bonus",
        pills: ["Bonus up to +5","Cap 105"],
        calculate: ([gaa,q1,q2,f,bonus]) => Math.min(105, 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2) + (bonus||0)),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      }
    },
    diploma: {
      "Machine Learning Foundations": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + max(0.6¬∑F + 0.2¬∑max(Q1,Q2), 0.4¬∑F + 0.2¬∑Q1 + 0.3¬∑Q2)",
        pills: ["Max-of-two-branches"],
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + Math.max(0.6*f + 0.2*Math.max(q1,q2), 0.4*f + 0.2*q1 + 0.3*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "Machine Learning Techniques": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"},{label:"Programming Bonus", hint:"0‚Äì3 allowed", min:0, max:3}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + max(0.25¬∑Q1 + 0.25¬∑Q2, 0.4¬∑max(Q1,Q2)) + Bonus",
        pills: ["Bonus up to +3"],
        calculate: ([gaa,q1,q2,f,bonus]) => 0.1*gaa + 0.4*f + Math.max(0.25*q1+0.25*q2, 0.4*Math.max(q1,q2)) + (bonus||0),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + attendance in ‚â•1 quiz"
      },
      "Machine Learning Practice": {
        inputs: [{label:"GAA"},{label:"OPPE1"},{label:"OPPE2"},{label:"Kaggle Average"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.30¬∑F + 0.20¬∑OPPE1 + 0.20¬∑OPPE2 + 0.20¬∑KA",
        calculate: ([gaa,op1,op2,ka,f]) => 0.1*gaa + 0.30*f + 0.20*op1 + 0.20*op2 + 0.20*ka,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + ‚â•40% in ‚â•1 OPPE"
      },
      "Business Data Management": {
        inputs: [{label:"Best 3 GA (out of 4)"},{label:"Quiz 2"},{label:"ROE"},{label:"Final Exam"}],
        formula: "T = 0.3¬∑GA + 0.20¬∑Q2 + 0.2¬∑ROE + 0.3¬∑F",
        calculate: ([ga,q2,roe,f]) => 0.3*ga + 0.20*q2 + 0.2*roe + 0.3*f,
        eligibility: "Submit ‚â•1 of first two GAs & avg best 2 of first 3 ‚â• 40%"
      },
      // ---- FIXED: Business Analytics (percent inputs; internal weighting) ----
"Business Analytics": {
  inputs: [
    {label:"Assignments (best 2 of 3)", hint:"Enter 0‚Äì100"},
    {label:"Quiz 1", hint:"0‚Äì100"},
    {label:"Quiz 2", hint:"0‚Äì100"},
    {label:"Final Exam", hint:"0‚Äì100"}
  ],
  formula: "T = 0.4¬∑A + 0.2¬∑Qz + 0.4¬∑F, where Qz = 0.7¬∑max(Q1,Q2) + 0.3¬∑min(Q1,Q2)",
  pills: ["All inputs 0‚Äì100"],
  calculate: ([aPct,q1Pct,q2Pct,fPct]) => {
    const qz = 0.7*Math.max(q1Pct,q2Pct) + 0.3*Math.min(q1Pct,q2Pct); // 0‚Äì100
    return 0.4*aPct + 0.2*qz + 0.4*fPct; // out of 100
  },
  eligibility: "‚â•1 assignment submitted; Quiz ‚â•35%; End-term ‚â•25%"
},


      "Tools in Data Science": {
        inputs: [{label:"Best 4 GA (out of 7)"},{label:"ROE1"},{label:"Project 1"},{label:"Project 2"},{label:"Final Exam"}],
        formula: "T = 0.15¬∑GAA + 0.2¬∑ROE1 + 0.2¬∑P1 + 0.2¬∑P2 + 0.25¬∑F",
        calculate: ([gaa,roe1,p1,p2,f]) => 0.15*gaa + 0.2*roe1 + 0.2*p1 + 0.2*p2 + 0.25*f,
        eligibility: "Avg. best 4 of first 5 ‚â• 40%"
      },
      "PDSA": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"OPPE"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.2¬∑OP + max(0.2¬∑max(Q1,Q2), 0.15¬∑Q1 + 0.15¬∑Q2)",
        calculate: ([gaa,q1,q2,op,f]) => 0.1*gaa + 0.4*f + 0.2*op + Math.max(0.2*Math.max(q1,q2), 0.15*q1 + 0.15*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance + GrPA(2‚Äì8) ‚â• 40%"
      },
      "DBMS": {
        inputs: [{label:"GAA1"},{label:"GAA2 (SQL)"},{label:"GAA3 (Prog)"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"OPE"},{label:"Final Exam"}],
        formula: "T = 0.04¬∑GAA1 + 0.03¬∑GAA2 + 0.03¬∑GAA3 + 0.2¬∑OP + max(0.45¬∑F + 0.15¬∑max(Q1,Q2), 0.4¬∑F + 0.10¬∑Q1 + 0.20¬∑Q2)",
        calculate: ([g1,g2,g3,q1,q2,op,f]) => 0.04*g1 + 0.03*g2 + 0.03*g3 + 0.2*op + Math.max(0.45*f + 0.15*Math.max(q1,q2), 0.4*f + 0.10*q1 + 0.20*q2),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance + OPE ‚â• 35% with Python-DB Q"
      },
      "Application Development 1": {
        inputs: [{label:"Best 2 Lab Assignments (sum)"},{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.15¬∑GLA + 0.05¬∑GA + max(0.35¬∑F + 0.2¬∑Q1 + 0.25¬∑Q2, 0.4¬∑F + 0.3¬∑best(Q))",
        calculate: ([gla,ga,q1,q2,f]) => 0.15*gla + 0.05*ga + Math.max(0.35*f + 0.2*q1 + 0.25*q2, 0.4*f + 0.3*Math.max(q1,q2)),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      // ---- FIXED: Java Programming (Diploma) ----
      "Java Programming": {
        inputs: [
          {label:"GAA (Objective)"}, {label:"GAAP (Programming)"},
          {label:"Quiz 1"}, {label:"OPPE1"}, {label:"OPPE2"}, {label:"Final Exam"}
        ],
        formula: "T = 0.05¬∑GAA + 0.10¬∑GAAP + 0.15¬∑Q1 + 0.20¬∑OPPE1 + 0.20¬∑OPPE2 + 0.30¬∑F",
        calculate: ([gaa,gaap,q1,op1,op2,f]) => 0.05*gaa + 0.10*gaap + 0.15*q1 + 0.20*op1 + 0.20*op2 + 0.30*f,
        eligibility: "GrPA-based OPPE eligibility + final eligibility"
      },
      "System Commands": {
        inputs: [{label:"Best 9 GAA (out of 10)"},{label:"Quiz 1"},{label:"BPT Average"},{label:"OPE"},{label:"Final Exam"}],
        formula: "T = 0.10¬∑GAA + 0.2¬∑Q1 + 0.3¬∑OPE + 0.3¬∑F + 0.1¬∑BPTA",
        calculate: ([gaa,q1,bpta,ope,f]) => 0.10*gaa + 0.2*q1 + 0.3*ope + 0.3*f + 0.1*bpta,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + OPE ‚â• 40% + BPT avg ‚â• 40%"
      },
      "Application Development 2": {
        inputs: [{label:"GAA1"},{label:"GAA2 (Prog)"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.05¬∑GAA1 + 0.05¬∑GAA2 + max(0.35¬∑F + 0.25¬∑Q1 + 0.3¬∑Q2, 0.5¬∑F + 0.3¬∑best(Q))",
        calculate: ([g1,g2,q1,q2,f]) => 0.05*g1 + 0.05*g2 + Math.max(0.35*f + 0.25*q1 + 0.3*q2, 0.5*f + 0.3*Math.max(q1,q2)),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      }
    },
    degree: {
      "Software Testing": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2",
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Software Engineering": {
        inputs: [{label:"GAA"},{label:"Quiz 2"},{label:"Group Project 1"},{label:"Group Project 2"},{label:"Project Presentation"},{label:"Course Participation"},{label:"Final Exam"}],
        formula: "T = 0.05¬∑GAA + 0.2¬∑Q2 + 0.4¬∑F + 0.1¬∑GP1 + 0.1¬∑GP2 + 0.1¬∑PP + 0.05¬∑CP",
        calculate: ([gaa,q2,gp1,gp2,pp,cp,f]) => 0.05*gaa + 0.2*q2 + 0.4*f + 0.1*gp1 + 0.1*gp2 + 0.1*pp + 0.05*cp,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + GP Milestones"
      },
      "Deep Learning": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"},{label:"Programming Bonus", hint:"0‚Äì5", min:0, max:5}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2 + Bonus",
        pills: ["Bonus up to +5"],
        calculate: ([gaa,q1,q2,f,bonus]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2 + (bonus||0),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "AI: Search Methods for Problem Solving": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"},{label:"Programming Bonus", hint:"0‚Äì5", min:0, max:5}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2 + Bonus",
        pills: ["Bonus up to +5"],
        calculate: ([gaa,q1,q2,f,bonus]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2 + (bonus||0),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Strategies for Professional Growth": {
        inputs: [{label:"GAA"},{label:"Quiz 2"},{label:"Group Project"},{label:"Final Exam"}],
        formula: "T = 0.15¬∑GAA + 0.25¬∑GP + 0.25¬∑Q2 + 0.35¬∑F",
        calculate: ([gaa,q2,gp,f]) => 0.15*gaa + 0.25*gp + 0.25*q2 + 0.35*f,
        eligibility: "Avg. best 5 of first 7 ‚â• 40%"
      },
      "Introduction to Big Data": {
        inputs: [{label:"Best 6 GAA (out of 9)"},{label:"OPPE1"},{label:"OPPE2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.3¬∑F + 0.2¬∑OPPE1 + 0.4¬∑OPPE2",
        calculate: ([gaa,op1,op2,f]) => 0.1*gaa + 0.3*f + 0.2*op1 + 0.4*op2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + ‚â•40% in ‚â•1 OPPE"
      },
      "Programming in C": {
        inputs: [{label:"GAA (Objective)"},{label:"GAAP (Programming)"},{label:"Quiz 1"},{label:"OPPE1"},{label:"OPPE2"},{label:"Final Exam"}],
        formula: "T = 0.05¬∑GAA + 0.10¬∑GAAP + 0.15¬∑Q1 + 0.20¬∑OPPE1 + 0.20¬∑OPPE2 + 0.30¬∑F",
        calculate: ([gaa,gaap,q1,op1,op2,f]) => 0.05*gaa + 0.10*gaap + 0.15*q1 + 0.20*op1 + 0.20*op2 + 0.30*f,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + ‚â•40% in ‚â•1 OPPE"
      },
      "Deep Learning for CV": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2",
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Managerial Economics": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2",
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Algorithmic Thinking in Bioinformatics": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.2¬∑GAA + 0.2¬∑Q1 + 0.2¬∑Q2 + 0.4¬∑F",
        calculate: ([gaa,q1,q2,f]) => 0.2*gaa + 0.2*q1 + 0.2*q2 + 0.4*f,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Large Language Models": {
        inputs: [{label:"GAA (7 assignments)"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"},{label:"Programming Bonus", hint:"0‚Äì10", min:0, max:10}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2 + Bonus",
        pills: ["Bonus up to +10"],
        calculate: ([gaa,q1,q2,f,bonus]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2 + (bonus||0),
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Speech Technology": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Viva"},{label:"Final Exam"}],
        formula: "T = 0.15¬∑GAA + 0.15¬∑V + 0.3¬∑F + 0.20¬∑Q1 + 0.20¬∑Q2",
        calculate: ([gaa,q1,q2,v,f]) => 0.15*gaa + 0.15*v + 0.3*f + 0.20*q1 + 0.20*q2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Design Thinking for Data-Driven App Development": {
        inputs: [{label:"GAA"},{label:"Quiz 2"},{label:"Group Project 1"},{label:"Group Project 2"},{label:"Group Project 3"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.1¬∑GP1 + 0.1¬∑GP2 + 0.2¬∑GP3 + 0.2¬∑Q2 + 0.3¬∑F",
        calculate: ([gaa,q2,gp1,gp2,gp3,f]) => 0.1*gaa + 0.1*gp1 + 0.1*gp2 + 0.2*gp3 + 0.2*q2 + 0.3*f,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + final project > 60%"
      },
      "Market Research": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Project"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.2¬∑Q1 + 0.2¬∑Q2 + 0.25¬∑P + 0.25¬∑F",
        calculate: ([gaa,q1,q2,p,f]) => 0.1*gaa + 0.2*q1 + 0.2*q2 + 0.25*p + 0.25*f,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Statistical Computing": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2",
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Advanced Algorithms": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.15¬∑GAA + 0.35¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2",
        calculate: ([gaa,q1,q2,f]) => 0.15*gaa + 0.35*f + 0.25*q1 + 0.25*q2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Game Theory and Strategy": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.25¬∑Q1 + 0.25¬∑Q2",
        calculate: ([gaa,q1,q2,f]) => 0.1*gaa + 0.4*f + 0.25*q1 + 0.25*q2,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Computer System Design": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"Circuit Verse Assignment"},{label:"Final Exam"}],
        formula: "T = 0.1¬∑GAA + 0.4¬∑F + 0.2¬∑Q1 + 0.25¬∑Q2 + 0.05¬∑CV",
        calculate: ([gaa,q1,q2,cv,f]) => 0.1*gaa + 0.4*f + 0.2*q1 + 0.25*q2 + 0.05*cv,
        eligibility: "Avg. best 5 of first 7 ‚â• 40% + quiz attendance"
      },
      "Mathematical Foundations of Generative AI": {
        inputs: [{label:"GAA"},{label:"Quiz 1"},{label:"Quiz 2"},{label:"OPPE"},{label:"Final Exam"}],
        formula: "T = 0.2¬∑GAA + 0.35¬∑F + 0.10¬∑Q1 + 0.15¬∑Q2 + 0.2¬∑OPPE",
        calculate: ([gaa,q1,q2,oppe,f]) => 0.2*gaa + 0.35*f + 0.10*q1 + 0.15*q2 + 0.2*oppe,
        eligibility: "Avg. best 5 of first 7 ‚â• 40%"
      },
      "Algorithms for Data Science": {
        inputs: [{label:"GAA (5 assignments)"},{label:"Quiz 2"},{label:"Final Exam"}],
        formula: "T = 0.2¬∑GAA + 0.45¬∑F + 0.35¬∑Q2",
        calculate: ([gaa,q2,f]) => 0.2*gaa + 0.45*f + 0.35*q2,
        eligibility: "Avg. best 2 of first 3 assignments ‚â• 40%"
      },
      "MLOPS": {
        inputs: [{label:"GAA"},{label:"OPPE1"},{label:"OPPE2"},{label:"Final Exam"},{label:"Live Session Bonus", hint:"0‚Äì5", min:0, max:5}],
        formula: "T = 0.1¬∑GAA + 0.3¬∑F + 0.3¬∑OPPE1 + 0.3¬∑OPPE2 + Bonus",
        pills: ["Bonus up to +5"],
        calculate: ([gaa,op1,op2,f,bonus]) => 0.1*gaa + 0.3*f + 0.3*op1 + 0.3*op2 + (bonus||0),
        eligibility: "Avg. best 5 of first 7 ‚â• 40%"
      }
    }
  };

  let currentLevel = 'foundation';
  let currentCourse = null;

  function initializeLevelButtons() {
    const levelButtons = document.querySelectorAll('.level-btn');
    levelButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        levelButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentLevel = btn.dataset.level;
        updateCourseOptions();
        document.getElementById('inputSection').classList.remove('active');
        document.getElementById('resultSection').classList.remove('active');
      });
    });
  }

  function updateCourseOptions() {
    const courseSelect = document.getElementById('courseSelect');
    courseSelect.innerHTML = '<option value="">Select a course...</option>';
    const levelCourses = courses[currentLevel];
    Object.keys(levelCourses).forEach(courseName => {
      const option = document.createElement('option');
      option.value = courseName;
      option.textContent = courseName;
      courseSelect.appendChild(option);
    });
    courseSelect.onchange = (e) => {
      if (e.target.value) {
        currentCourse = levelCourses[e.target.value];
        setupInputs();
      } else {
        document.getElementById('inputSection').classList.remove('active');
        document.getElementById('resultSection').classList.remove('active');
      }
    };
  }

  function setupInputs() {
    const inputGrid = document.getElementById('inputGrid');
    inputGrid.innerHTML = '';
    currentCourse.inputs.forEach((cfg, idx) => {
      const id = `input-${idx}`;
      const group = makeInputGroup({
        label: cfg.label,
        id,
        min: cfg.min ?? 0, max: cfg.max ?? 100, step: cfg.step ?? 0.01,
        placeholder: cfg.placeholder ?? 'Enter score (0-100)',
        hint: cfg.hint ?? ''
      });
      inputGrid.appendChild(group);
    });

    document.getElementById('inputSection').classList.add('active');
    updateFormulaDisplay();
  }

function updateFormulaDisplay() {
  document.getElementById('formulaDisplay').textContent = currentCourse.formula;

  const infoList = document.getElementById('infoList');
  infoList.innerHTML = `
    <li>Enter 0 for components you didn't attempt</li>
    <li>All scores are percentages (0‚Äì100) unless noted</li>
    <li>Eligibility: ${currentCourse.eligibility}</li>
    <li>Result follows the formula shown above</li>
  `;

  // pills (caps/bonus/etc)
  const formulaBox = document.querySelector('.formula-display');
  formulaBox.querySelectorAll('.pill').forEach(p => p.remove());
  if (currentCourse.pills && currentCourse.pills.length) {
    currentCourse.pills.forEach(text => {
      const pill = document.createElement('span');
      pill.className = 'pill';
      pill.textContent = text;
      formulaBox.insertBefore(pill, document.getElementById('formulaDisplay'));
    });
  }

  // BA-only one-liner warning
  const selectedName = document.getElementById('courseSelect').value;
  const existing = document.getElementById('baWarning');
  if (existing) existing.remove();
  if (selectedName === 'Business Analytics') {
    const li = document.createElement('li');
    li.id = 'baWarning';
    li.className = 'warning-line';
    li.textContent = "Business Analytics: this calculator might be slightly off in special/edge cases.";
    infoList.appendChild(li);
  }
}


  function checkEligibility(level, courseName, values) {
  // Return {ok: boolean, reason?: string}
  switch (courseName) {
    case "Machine Learning Practice": {
      const oppe1 = values[1], oppe2 = values[2];
      return (oppe1 >= 40 || oppe2 >= 40)
        ? { ok: true }
        : { ok: false, reason: "OPPE1 or OPPE2 must be ‚â• 40%" };
    }
    case "Introduction to Big Data": {
      const oppe1 = values[1], oppe2 = values[2];
      return (oppe1 >= 40 || oppe2 >= 40)
        ? { ok: true }
        : { ok: false, reason: "OPPE1 or OPPE2 must be ‚â• 40%" };
    }
    case "Programming in C": {
      const oppe1 = values[3], oppe2 = values[4];
      return (oppe1 >= 40 || oppe2 >= 40)
        ? { ok: true }
        : { ok: false, reason: "OPPE1 or OPPE2 must be ‚â• 40%" };
    }
    case "System Commands": {
      const bpt = values[2], ope = values[3];
      return (bpt >= 40 && ope >= 40)
        ? { ok: true }
        : { ok: false, reason: "BPT Average ‚â• 40% and OPE ‚â• 40% required" };
    }
    case "DBMS": {
      const ope = values[5];
      return (ope >= 35)
        ? { ok: true }
        : { ok: false, reason: "OPE must be ‚â• 35%" };
    }
    default:
      return { ok: true };
  }
}


function calculateGrade() {
  const inputs = Array.from(document.querySelectorAll('#inputGrid input'));
  const values = inputs.map(input => {
    const v = parseFloat(input.value);
    return Number.isFinite(v) ? v : 0;
  });

  const totalScore = currentCourse.calculate(values);
  let grade = getGradeFromScore(totalScore);

  // NEW: eligibility override (OPPE-related)
  const courseName = document.getElementById('courseSelect').value;
  const elig = checkEligibility(currentLevel, courseName, values);
  let note = '<span class="small-muted"> | Pass threshold: 40 (E)</span>';
  if (!elig.ok) {
    grade = 'U';
    note = ` <span class="small-muted">| Eligibility not met: ${elig.reason}</span>`;
  }

  document.getElementById('resultValue').textContent = totalScore.toFixed(2);
  document.getElementById('resultGrade').innerHTML = `Grade: ${grade}${note}`;
  document.getElementById('resultSection').classList.add('active');

  let legend = document.getElementById('gradeLegend');
  if (!legend) {
    legend = document.createElement('div');
    legend.id = 'gradeLegend';
    legend.className = 'hint';
    legend.style.textAlign = 'center';
    legend.style.marginTop = '10px';
    legend.textContent = "Scale: S ‚â•90, A ‚â•80, B ‚â•70, C ‚â•60, D ‚â•50, E ‚â•40, else U";
    document.getElementById('resultSection').appendChild(legend);
  }
}


  // wire button
  window.calculateGrade = calculateGrade;

  // init
  document.addEventListener('DOMContentLoaded', () => {
    initializeLevelButtons();
    updateCourseOptions();
  });
    </script>
</body>
</html>